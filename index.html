<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Print Demo</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 15px;
      height: 100vh;
      background: #f5f5f5;
    }
    button {
      padding: 12px 24px;
      font-size: 18px;
      border: none;
      border-radius: 6px;
      background-color: #007bff;
      color: white;
      cursor: pointer;
      width: 250px;
    }
    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <h1>Print Demo (3 Methods)</h1>
  <p>Try all 3 print options below:</p>

  <!-- 1️⃣ Standard window.print() -->
  <button onclick="goToPrintPage()">System Print Popup</button>

  <!-- 2️⃣ RawBT Intent -->
  <button onclick="printViaIntent()">Print via RawBT (Intent)</button>

  <!-- 3️⃣ RawBT Local API -->
  <button onclick="printViaLocalAPI()">Print via RawBT (Local API)</button>

  <script>
    // Method 1: Redirect to print.html (window.print)
    function goToPrintPage() {
      window.location.href = "print.html";
    }

    // Method 2: Open RawBT via Android Intent
    function printViaIntent() {
      // This link will try to open RawBT directly
      window.location.href = "intent://print/#Intent;scheme=rawbt;package=ru.a402d.rawbtprinter;end";
    }

    // Method 3: Send print data to RawBT local API
    async function printViaLocalAPI() {
      const textToPrint = "Hello from RawBT Local API!\nPrinted via web app.\n\n";
      const ports = [8080, 9100, 9000]; // Common RawBT local ports

      let printed = false;

      for (let port of ports) {
        try {
          const response = await fetch(`http://127.0.0.1:${port}/print`, {
            method: "POST",
            body: textToPrint,
            headers: { "Content-Type": "text/plain" },
          });
          if (response.ok) {
            alert("✅ Sent to RawBT (port " + port + ")");
            printed = true;
            break;
          }
        } catch (e) {
          // Try next port
        }
      }

      if (!printed) {
        alert("⚠️ Could not reach RawBT local server.\nEnable it in RawBT Settings → Web Interface → Enable.");
      }
    }
  </script>
</body>
</html>
